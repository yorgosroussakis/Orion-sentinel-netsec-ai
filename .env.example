# Orion Sentinel Environment Configuration
# 
# This file documents all required and optional environment variables
# for the Orion Sentinel NetSec Pi network security monitoring stack.
#
# Copy this file to .env and customize for your environment:
#   cp .env.example .env
#   nano .env
#
# Required configuration before starting:
#   1. Set NETSEC_INTERFACE to your mirrored traffic interface
#   2. Set LOKI_URL to your CoreSrv Loki endpoint
#   3. Verify NVMe is mounted at NVME_MOUNT

# =============================================================================
# Project Configuration
# =============================================================================
# Docker Compose project name (used as prefix for containers/volumes)
COMPOSE_PROJECT_NAME=orion-netsec

# Timezone (used by containers for log timestamps)
TZ=Europe/Amsterdam

# =============================================================================
# Network Interface Configuration (REQUIRED)
# =============================================================================
# Interface to monitor for mirrored/SPAN traffic from switch
# This should be a dedicated interface receiving port-mirrored traffic
# 
# Examples:
#   - eth0, eth1 (built-in Ethernet)
#   - enx00e04c68xxxx (USB Ethernet adapter)
#   - wlan0 (WiFi - not recommended for production)
# 
# Verify available interfaces: ip link show
# Test traffic on interface: sudo tcpdump -i eth0 -c 10
NETSEC_INTERFACE=eth0

# =============================================================================
# NVMe Storage Configuration (REQUIRED)
# =============================================================================
# NVMe mount point on host where all logs/PCAPs will be stored
#
# IMPORTANT:
# - NVMe must be mounted BEFORE starting services
# - Run ./scripts/check-nvme.sh to verify setup
# - See docs/architecture-netsec.md for fstab configuration
#
# Default: /mnt/orion-nvme-netsec
# Required subdirectories (created automatically if missing):
#   - suricata/logs
#   - suricata/pcaps (if PCAP logging enabled)
#   - suricata/rules
#   - promtail
NVME_MOUNT=/mnt/orion-nvme-netsec

# Minimum free disk space (GB) before check-nvme.sh warns
MIN_FREE_GB=5

# NVMe health check thresholds (used by check-nvme.sh)
# These are percentage-based thresholds
NVME_WARN_THRESHOLD=80      # Warn at 80% disk usage
NVME_CRITICAL_THRESHOLD=95  # Fail at 95% disk usage

# =============================================================================
# Node Identification (Recommended for multi-node deployments)
# =============================================================================
# Unique name for this NetSec node
# Used in Loki labels and Grafana dashboards
NODE_NAME=netsec-pi-01

# Orion node role (for Loki labels)
ORION_NODE_ROLE=netsec

# Orion node name (for Loki labels, same as NODE_NAME typically)
ORION_NODE_NAME=netsec-pi-01

# Physical location (helps with troubleshooting)
NODE_LOCATION=home-lab

# Hostname (must match system hostname for proper log labeling)
HOSTNAME=netsec-pi-01

# =============================================================================
# Suricata IDS Configuration
# =============================================================================
# Enable PCAP (packet capture) storage
# Warning: PCAPs consume significant disk space - use only for debugging
# Set to true to enable, false to disable
SURICATA_ENABLE_PCAP=false

# Suricata log directory (inside container)
SURICATA_LOG_DIR=/var/log/suricata

# Suricata PCAP directory (inside container, when PCAP enabled)
SURICATA_PCAP_DIR=/var/log/suricata/pcap

# =============================================================================
# Promtail / Log Shipping Labels
# =============================================================================
# Labels applied to logs shipped to Loki
# Note: Set these to match your ORION_NODE_NAME and ORION_NODE_ROLE values above
# These are used by Promtail to label logs for filtering in Grafana
PROMTAIL_LABEL_ORION_NODE_NAME=netsec-pi-01
PROMTAIL_LABEL_ORION_NODE_ROLE=netsec
PROMTAIL_LABEL_ENV=home

# =============================================================================
# Loki (Log Aggregation) - CoreSrv Integration
# =============================================================================
# Central Loki endpoint for log aggregation
# 
# Production (SPoG mode - RECOMMENDED):
#   Point to CoreSrv Loki on your LAN
#   Example: http://192.168.8.50:3100
#   Set LOCAL_OBSERVABILITY=false
# 
# Development/Lab (Standalone mode):
#   Use local Loki container (requires docker-compose.local-observability.yml)
#   Set LOKI_URL=http://loki:3100
#   Set LOCAL_OBSERVABILITY=true
# 
# Replace <CORESRV_IP> with your CoreSrv IP address
LOKI_URL=http://<CORESRV_IP>:3100

# Enable local Loki+Grafana stack (dev/lab only)
# Production: false (use CoreSrv)
# Dev/lab: true (run local observability stack)
LOCAL_OBSERVABILITY=false

# Optional: Loki authentication (if CoreSrv has auth enabled)
# LOKI_USERNAME=
# LOKI_PASSWORD=

# =============================================================================
# Prometheus (Metrics Collection) - CoreSrv Integration
# =============================================================================
# CoreSrv Prometheus endpoint
# 
# In SPoG mode (production):
#   Point to CoreSrv Prometheus for metrics scraping
#   Example: http://192.168.8.50:9090
#   CoreSrv will scrape Node Exporter on NetSec Pi (port 9100)
# 
# In standalone mode:
#   Not needed (no Prometheus running locally)
# 
# Replace <CORESRV_IP> with your CoreSrv IP address
PROMETHEUS_URL=http://<CORESRV_IP>:9090

# Node Exporter port (exposed for CoreSrv Prometheus scraping)
# Default: 9100
# Ensure firewall allows CoreSrv to reach this port
NODE_EXPORTER_PORT=9100

# =============================================================================
# EveBox (Optional Local UI)
# =============================================================================
# EveBox web UI port for local Suricata alert browsing
# Only used with 'netsec-plus-evebox' profile
# 
# Access: http://netsec-pi-ip:5636
# Default: 5636
EVEBOX_PORT=5636

# =============================================================================
# SOAR (Security Orchestration and Automated Response)
# =============================================================================
SOAR_DRY_RUN=1
SOAR_POLL_INTERVAL=60
SOAR_PLAYBOOKS_FILE=/config/playbooks.yml
SOAR_ALLOW_EMPTY_PLAYBOOKS=0

# =============================================================================
# Notifications
# =============================================================================

# --- Email Notifications (SMTP) ---
NOTIFY_SMTP_HOST=smtp.gmail.com
NOTIFY_SMTP_PORT=587
NOTIFY_SMTP_USER=
NOTIFY_SMTP_PASS=
NOTIFY_EMAIL_FROM=
NOTIFY_EMAIL_TO=
NOTIFY_SMTP_USE_TLS=true

# --- Signal Notifications ---
# Requires signal-cli with REST API running
NOTIFY_SIGNAL_ENABLED=false
NOTIFY_SIGNAL_API_URL=http://signal-cli:8080
NOTIFY_SIGNAL_NUMBER=
NOTIFY_SIGNAL_RECIPIENTS=

# --- Telegram Notifications ---
# Get bot token from @BotFather on Telegram
NOTIFY_TELEGRAM_ENABLED=false
NOTIFY_TELEGRAM_BOT_TOKEN=
NOTIFY_TELEGRAM_CHAT_ID=

# --- Webhook Notifications ---
NOTIFY_WEBHOOK_URL=
NOTIFY_WEBHOOK_TOKEN=

# =============================================================================
# Threat Intelligence
# =============================================================================
IOC_STORE_PATH=/data/threat_intel.db

# AlienVault OTX (requires free API key from otx.alienvault.com)
TI_ENABLE_OTX=false
TI_OTX_API_KEY=

# abuse.ch URLhaus (no key required)
TI_ENABLE_URLHAUS=true

# abuse.ch Feodo Tracker (no key required)
TI_ENABLE_FEODO=true

# PhishTank (optional key for higher rate limits)
TI_ENABLE_PHISHTANK=true
TI_PHISHTANK_API_KEY=

# =============================================================================
# Pi-hole Integration
# =============================================================================
PIHOLE_URL=http://192.168.1.2
PIHOLE_API_KEY=your-pihole-api-key-here

# =============================================================================
# Device Inventory
# =============================================================================
INVENTORY_POLL_INTERVAL=300
INVENTORY_DB_PATH=/data/inventory.db

# =============================================================================
# Change Monitor
# =============================================================================
CHANGE_MONITOR_INTERVAL_HOURS=24
CHANGE_MONITOR_PERIOD_DAYS=7

# =============================================================================
# Health Score
# =============================================================================
HEALTH_SCORE_INTERVAL_HOURS=1

# =============================================================================
# Web UI / API Server
# =============================================================================
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=false

# =============================================================================
# Grafana
# =============================================================================
GRAFANA_ADMIN_PASSWORD=admin

# =============================================================================
# Logging
# =============================================================================
LOG_LEVEL=INFO

# =============================================================================
# Future AI Node Integration (NOT required now)
# =============================================================================
# These settings are documented for future AI node integration
# The NetSec stack works fully without an AI node
#
# When AI node is deployed:
#   1. Set ORION_AI_ENABLED=true
#   2. Set ORION_AI_GATEWAY_URL to the AI node's API endpoint
#   3. Restart services
#
# AI Node will:
#   - Read logs from CoreSrv Loki
#   - Perform AI inference (anomaly detection, risk scoring)
#   - Publish enriched alerts back to Loki
#   - See docs/ai-node-future.md for details
ORION_AI_ENABLED=false
ORION_AI_GATEWAY_URL=
